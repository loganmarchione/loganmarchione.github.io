<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Encrypted external drive with LUKS | Logan Marchione</title>
<meta name="keywords" content="">
<meta name="description" content="Update: LUKS2 is out, use it instead! LUKS2 was released in 2018, you should double-check the documentation for it before you blindly follow this guide. üôÉ
Introduction Since TrueCrypt is no longer under active development, I&rsquo;ve decided to wipe my external drives and re-encrypt them with LUKS and dm-crypt. These are standard Linux tools that are available by default in most distributions. I&rsquo;ve used LUKS and dm-crypt in the past, when I installed Arch Linux on my laptop.">
<meta name="author" content="Logan Marchione">
<link rel="canonical" href="https://loganmarchione.github.io/2015/05/encrypted-external-drive-with-luks/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.c7cdb1f41be44725a12b6dc05dfde4f5f9ae85dd5e86f4c4d2df6b19d2add58b.css" integrity="sha256-x82x9BvkRyWhK23AXf3k9fmuhd1ehvTE0t9rGdKt1Ys=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://loganmarchione.github.io/assets/favicon/favicon_loganmarchione_logo.svg">
<link rel="icon" type="image/png" sizes="16x16" href="https://loganmarchione.github.io/assets/favicon/favicon_loganmarchione_logo.svg">
<link rel="icon" type="image/png" sizes="32x32" href="https://loganmarchione.github.io/assets/favicon/favicon_loganmarchione_logo.svg">
<link rel="apple-touch-icon" href="https://loganmarchione.github.io/assets/favicon/apple-touch-icon.png">
<link rel="mask-icon" href="https://loganmarchione.github.io/assets/favicon/favicon_loganmarchione_logo.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><script async defer data-domain="loganmarchione.com" src="https://plausible.io/js/plausible.js"></script><meta property="og:title" content="Encrypted external drive with LUKS" />
<meta property="og:description" content="Update: LUKS2 is out, use it instead! LUKS2 was released in 2018, you should double-check the documentation for it before you blindly follow this guide. üôÉ
Introduction Since TrueCrypt is no longer under active development, I&rsquo;ve decided to wipe my external drives and re-encrypt them with LUKS and dm-crypt. These are standard Linux tools that are available by default in most distributions. I&rsquo;ve used LUKS and dm-crypt in the past, when I installed Arch Linux on my laptop." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://loganmarchione.github.io/2015/05/encrypted-external-drive-with-luks/" />
<meta property="og:image" content="https://loganmarchione.github.io/assets/featured/featured_generic_key.svg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-05-06T00:00:00+00:00" />
<meta property="article:modified_time" content="2015-05-06T00:00:00+00:00" /><meta property="og:site_name" content="Logan Marchione" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://loganmarchione.github.io/assets/featured/featured_generic_key.svg" />
<meta name="twitter:title" content="Encrypted external drive with LUKS"/>
<meta name="twitter:description" content="Update: LUKS2 is out, use it instead! LUKS2 was released in 2018, you should double-check the documentation for it before you blindly follow this guide. üôÉ
Introduction Since TrueCrypt is no longer under active development, I&rsquo;ve decided to wipe my external drives and re-encrypt them with LUKS and dm-crypt. These are standard Linux tools that are available by default in most distributions. I&rsquo;ve used LUKS and dm-crypt in the past, when I installed Arch Linux on my laptop."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://loganmarchione.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Encrypted external drive with LUKS",
      "item": "https://loganmarchione.github.io/2015/05/encrypted-external-drive-with-luks/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Encrypted external drive with LUKS",
  "name": "Encrypted external drive with LUKS",
  "description": "Update: LUKS2 is out, use it instead! LUKS2 was released in 2018, you should double-check the documentation for it before you blindly follow this guide. üôÉ\nIntroduction Since TrueCrypt is no longer under active development, I\u0026rsquo;ve decided to wipe my external drives and re-encrypt them with LUKS and dm-crypt. These are standard Linux tools that are available by default in most distributions. I\u0026rsquo;ve used LUKS and dm-crypt in the past, when I installed Arch Linux on my laptop.",
  "keywords": [
    
  ],
  "articleBody": "Update: LUKS2 is out, use it instead! LUKS2 was released in 2018, you should double-check the documentation for it before you blindly follow this guide. üôÉ\nIntroduction Since TrueCrypt is no longer under active development, I‚Äôve decided to wipe my external drives and re-encrypt them with LUKS and dm-crypt. These are standard Linux tools that are available by default in most distributions. I‚Äôve used LUKS and dm-crypt in the past, when I installed Arch Linux on my laptop. Here, I‚Äôll be performing a similar procedure, but without LVM.\nCreating the encrypted drive Step 1 - Identify your disk Make sure you know which disk you‚Äôre working with by using lsblk.\nsudo lsblk Here, you can see the physical disk called /dev/sdb, which is my 1TB external drive. Do not assume that your drive will be /dev/sdb.\nNAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT sda 8:0 0 298.1G 0 disk ‚îú‚îÄsda1 8:1 0 1007K 0 part ‚îú‚îÄsda2 8:2 0 128M 0 part /boot ‚îî‚îÄsda3 8:3 0 298G 0 part ‚îî‚îÄVolGroup00 254:0 0 298G 0 crypt ‚îú‚îÄVolGroup00-lvolswap 254:1 0 8G 0 lvm [SWAP] ‚îú‚îÄVolGroup00-lvolroot 254:2 0 25G 0 lvm / ‚îî‚îÄVolGroup00-lvolhome 254:3 0 265G 0 lvm /home sdb 8:16 0 931.5G 0 disk Step 2 - Securely wipe your disk You should always wipe your disk before doing anything. Unfortunately, depending on the size of the disk, this could take a long time. If your drive is already encrypted, you could simply wipe the header and your data would be safe. Since I‚Äôm paranoid, I always choose to nuke the entire drive. You could use badblocks to do a destructive write test (as I did here), or use dd, as shown below. If you‚Äôre using a SSD, your techniques will have to be a little different.\nsudo dd if=/dev/zero of=/dev/sdb iflag=nocache oflag=direct bs=4096 Please don‚Äôt copy/paste this command directly, as you could risk destroying your current system. I‚Äôm not responsible for anything you break. ü§∑‚Äç‚ôÇÔ∏è\nStep 3 - Create partition Start by creating a partition using fdisk.\nsudo fdisk /dev/sdb Use the n option to create a new partition, then press p for a primary partition. Press 1 to¬†edit the first partition, then use the defaults for first and last sectors (this will fill up the entire drive). Finally, press w to write your changes.\nCommand (m for help): n Partition type p primary (0 primary, 0 extended, 4 free) e extended (container for logical partitions) Select (default p): p Partition number (1-4, default 1): 1 First sector (2048-1953458175, default 2048): Last sector, +sectors or +size{K,M,G,T,P} (2048-1953458175, default 1953458175): Created a new partition 1 of type 'Linux' and of size 931.5 GiB. Command (m for help): w The partition table has been altered. Calling ioctl() to re-read partition table. Syncing disks. Running lsblk again, we can see our new partition, /dev/sdb1.\nNAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT sda 8:0 0 298.1G 0 disk ‚îú‚îÄsda1 8:1 0 1007K 0 part ‚îú‚îÄsda2 8:2 0 128M 0 part /boot ‚îî‚îÄsda3 8:3 0 298G 0 part ‚îî‚îÄVolGroup00 254:0 0 298G 0 crypt ‚îú‚îÄVolGroup00-lvolswap 254:1 0 8G 0 lvm [SWAP] ‚îú‚îÄVolGroup00-lvolroot 254:2 0 25G 0 lvm / ‚îî‚îÄVolGroup00-lvolhome 254:3 0 265G 0 lvm /home sdb 8:16 0 931.5G 0 disk ‚îî‚îÄsdb1 8:17 0 931.5G 0 part Step 4 - Encrypt partition Here, we‚Äôll setup encryption on our new partition.\nsudo cryptsetup -v -y -c aes-xts-plain64 -s 512 -h sha512 -i 5000 --use-random luksFormat /dev/sdb1 Option Description -v verbose -y verify passphrase, ask twice, and complain if they don‚Äôt match -c specify the cipher used -s specify the key size used -h specify the hash used -i number of milliseconds to spend passphrase processing (if using anything more than sha1, must be great than 1000) --use-random which random number generator to use luksFormat to initialize the partition and set a passphrase /dev/sdb1 the partition to encrypt Seriously, read the man page and the FAQ on cryptsetup before you do anything here.\nTo see the configuration of the header, use the command below.\nsudo cryptsetup luksDump /dev/sdb1 Step 4.5 - Backup the LUKS header The LUKS header stores metadata about the LUKS device, as well as the master key, key files, etc‚Ä¶ Specifically, from the cryptsetup FAQ and specification:\nA LUKS partition starts with the LUKS partition header (phdr) and is followed by key material. After the key material, the bulk data is located, which is encrypted by the master key. The phdr contains information about the used cipher, cipher mode, the key length, a uuid and a master key checksum. Also, the phdr contains information about the key slots. Every key slot is associated with a key material section after the phdr.¬†When a key slot is active, the key slot stores an encrypted copy of the master key in its key material section. This encrypted copy is locked by a user password. Supplying this user password unlocks the decryption for the key material, which stores the master key. The master key in turn unlocks the bulk data. For a key slot, all parameters how to decrypt its key material with a given user password are stored in the phdr (f.e. salt, iteration depth).\nThat paragraph is probably easier explained with an image.\nIf you don‚Äôt understand already, it‚Äôs important to not damage the LUKS header. It‚Äôs best practice to backup the header as soon as you create the LUKS device, because you‚Äôre probably lazy and won‚Äôt do it later. If you damage the header at all (accidental formatting, wrong device when using dd, bad block, etc‚Ä¶), you‚Äôll need this backup header to recover the data. The header file itself needs encrypted and should be stored in safe place (not on the same drive, obviously).\nsudo cryptsetup luksHeaderBackup --header-backup-file /path/to/file.img /dev/sdb1 Note - TrueCrypt (brilliant piece of software) uses a backup header at the end of the drive as well, to mitigate the risk of a single header.\nStep 5 - Unlock the LUKS device Open the LUKS container using the passphrase you just set. This will mount the device at /dev/mapper/volume01.\nsudo cryptsetup luksOpen /dev/sdb1 volume01 Step 6 - Create filesystem I‚Äôm going to be using ext4. Again, specify the name of device you set in the step above.\nsudo mkfs.ext4 /dev/mapper/volume01 Step 7 - Mount device Here, create a mount point, then mount the device to that location.\nsudo mkdir -p /mnt/drive01 sudo mount /dev/mapper/volume01 /mnt/drive01 Step 8 - Unmount and close container Now, unmount the drive and close the LUKS container.\nsudo umount /mnt/drive01 sudo cryptsetup luksClose /dev/mapper/volume01 Mounting the encrypted drive Every time you want to use this drive, you‚Äôll need to open the LUKS container, mount the drive, do your work, unmount the drive, then close the LUKS container. You can do this manually, or a file manager to auto-mount it.\nManual Below are the steps to manually unlock and use the drive.\nsudo cryptsetup luksOpen /dev/sdb1 volume01 sudo mount /dev/mapper/volume01 /mnt/drive01 ##DO YOUR WORK HERE## sudo umount /mnt/drive01 sudo cryptsetup luksClose /dev/mapper/volume01 Automatic Modern file managers like Thunar and Nautilus have support for unlocking and mounting LUKS devices automatically. The only downside to this setup is that you can‚Äôt use keyfiles in addition to passphrases.\nInstall and configure Thunar If you don‚Äôt have Thunar, you‚Äôll need it, along with a couple other packages.\nsudo pacman -S thunar thunar-volman gvfs gvfs-afc Open Thunar and navigate to Edit‚Äì\u003ePreferences‚Äì\u003eAdvanced and ensure that Enable Volume Management is checked.\nClick on Configure, and ensure that Mount removable drives when hot-plugged and Mount removable media when inserted are both checked. Click on Close to save your changes.\nMount drive Plug in your external drive and open Thunar. In the top-left, you should see your drive under DEVICES.\nWhen you click on the drive, you‚Äôll be prompted for the passphrase you set earlier.\nTo unmount the drive, right-click on it and select Unmount.\n-Logan\nComments Old comments from WordPress\n",
  "wordCount" : "1312",
  "inLanguage": "en",
  "image":"https://loganmarchione.github.io/assets/featured/featured_generic_key.svg","datePublished": "2015-05-06T00:00:00Z",
  "dateModified": "2015-05-06T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Logan Marchione"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://loganmarchione.github.io/2015/05/encrypted-external-drive-with-luks/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Logan Marchione",
    "logo": {
      "@type": "ImageObject",
      "url": "https://loganmarchione.github.io/assets/favicon/favicon_loganmarchione_logo.svg"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://loganmarchione.github.io" accesskey="h" title="Logan Marchione (Alt + H)">
                <img src="https://loganmarchione.github.io/assets/favicon/favicon_loganmarchione_logo.svg" alt="" aria-label="logo"
                    height="35">Logan Marchione</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://loganmarchione.github.io/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://loganmarchione.github.io/privacy" title="Privacy">
                    <span>Privacy</span>
                </a>
            </li>
            <li>
                <a href="https://loganmarchione.github.io/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://loganmarchione.github.io/index.xml" title="RSS">
                    <span>RSS</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Encrypted external drive with LUKS
    </h1>
    <div class="post-meta"><span title='2015-05-06 00:00:00 +0000 UTC'>2015-05-06</span>&nbsp;¬∑&nbsp;7 min&nbsp;¬∑&nbsp;1312 words&nbsp;¬∑&nbsp;Logan Marchione

</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="https://loganmarchione.github.io/assets/featured/featured_generic_key.svg" alt="featured image">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#update-luks2-is-out-use-it-instead" aria-label="Update: LUKS2 is out, use it instead!">Update: LUKS2 is out, use it instead!</a></li>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#creating-the-encrypted-drive" aria-label="Creating the encrypted drive">Creating the encrypted drive</a><ul>
                        
                <li>
                    <a href="#step-1---identify-your-disk" aria-label="Step 1 - Identify your disk">Step 1 - Identify your disk</a></li>
                <li>
                    <a href="#step-2---securely-wipe-your-disk" aria-label="Step 2 - Securely wipe your disk">Step 2 - Securely wipe your disk</a></li>
                <li>
                    <a href="#step-3---create-partition" aria-label="Step 3 - Create partition">Step 3 - Create partition</a></li>
                <li>
                    <a href="#step-4---encrypt-partition" aria-label="Step 4 - Encrypt partition">Step 4 - Encrypt partition</a></li>
                <li>
                    <a href="#step-45---backup-the-luks-header" aria-label="Step 4.5 - Backup the LUKS header">Step 4.5 - Backup the LUKS header</a></li>
                <li>
                    <a href="#step-5---unlock-the-luks-device" aria-label="Step 5 - Unlock the LUKS device">Step 5 - Unlock the LUKS device</a></li>
                <li>
                    <a href="#step-6---create-filesystem" aria-label="Step 6 - Create filesystem">Step 6 - Create filesystem</a></li>
                <li>
                    <a href="#step-7---mount-device" aria-label="Step 7 - Mount device">Step 7 - Mount device</a></li>
                <li>
                    <a href="#step-8---unmount-and-close-container" aria-label="Step 8 - Unmount and close container">Step 8 - Unmount and close container</a></li></ul>
                </li>
                <li>
                    <a href="#mounting-the-encrypted-drive" aria-label="Mounting the encrypted drive">Mounting the encrypted drive</a><ul>
                        
                <li>
                    <a href="#manual" aria-label="Manual">Manual</a></li>
                <li>
                    <a href="#automatic" aria-label="Automatic">Automatic</a><ul>
                        
                <li>
                    <a href="#install-and-configure-thunar" aria-label="Install and configure Thunar">Install and configure Thunar</a></li>
                <li>
                    <a href="#mount-drive" aria-label="Mount drive">Mount drive</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#comments" aria-label="Comments">Comments</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="update-luks2-is-out-use-it-instead">Update: LUKS2 is out, use it instead!<a hidden class="anchor" aria-hidden="true" href="#update-luks2-is-out-use-it-instead">#</a></h1>
<p><a href="https://gitlab.com/cryptsetup/cryptsetup/-/blob/master/docs/v2.0.0-ReleaseNotes">LUKS2 was released in 2018</a>, you should double-check the documentation for it before you blindly follow this guide. üôÉ</p>
<h1 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h1>
<p>Since TrueCrypt is <a href="/2014/06/update-truecrypt-may-secure/">no longer</a> under active development, I&rsquo;ve decided to wipe my external drives and re-encrypt them with LUKS and dm-crypt. These are standard Linux tools that are available by default in most distributions. I&rsquo;ve used LUKS and dm-crypt in the past, when I installed Arch Linux on my laptop. Here, I&rsquo;ll be performing a similar procedure, but without LVM.</p>
<h1 id="creating-the-encrypted-drive">Creating the encrypted drive<a hidden class="anchor" aria-hidden="true" href="#creating-the-encrypted-drive">#</a></h1>
<h2 id="step-1---identify-your-disk">Step 1 - Identify your disk<a hidden class="anchor" aria-hidden="true" href="#step-1---identify-your-disk">#</a></h2>
<p>Make sure you know which disk you&rsquo;re working with by using <em>lsblk</em>.</p>
<pre tabindex="0"><code>sudo lsblk
</code></pre><p>Here, you can see the physical disk called <em>/dev/sdb</em>, which is my 1TB external drive. Do not assume that your drive will be <em>/dev/sdb</em>.</p>
<pre tabindex="0"><code>NAME                      MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINT
sda                         8:0    0 298.1G  0 disk  
‚îú‚îÄsda1                      8:1    0  1007K  0 part  
‚îú‚îÄsda2                      8:2    0   128M  0 part  /boot
‚îî‚îÄsda3                      8:3    0   298G  0 part  
  ‚îî‚îÄVolGroup00            254:0    0   298G  0 crypt 
    ‚îú‚îÄVolGroup00-lvolswap 254:1    0     8G  0 lvm   [SWAP]
    ‚îú‚îÄVolGroup00-lvolroot 254:2    0    25G  0 lvm   /
    ‚îî‚îÄVolGroup00-lvolhome 254:3    0   265G  0 lvm   /home
sdb                         8:16   0 931.5G  0 disk
</code></pre><h2 id="step-2---securely-wipe-your-disk">Step 2 - Securely wipe your disk<a hidden class="anchor" aria-hidden="true" href="#step-2---securely-wipe-your-disk">#</a></h2>
<p>You should always wipe your disk before doing anything. Unfortunately, depending on the size of the disk, this could take a long time. If your drive is already encrypted, you could simply <a href="https://wiki.archlinux.org/index.php/Dm-crypt/Drive_preparation#Wipe_LUKS_header">wipe the header</a> and your data would be safe. Since I&rsquo;m paranoid, I always choose to <a href="https://wiki.archlinux.org/index.php/Securely_wipe_disk">nuke the entire drive</a>. You could use <em>badblocks</em> to do a destructive write test (as I did here), or use <em>dd</em>, as <a href="https://wiki.archlinux.org/index.php/Securely_wipe_disk#Overwrite_the_target">shown below</a>. If you&rsquo;re using a SSD, your <a href="https://www.usenix.org/legacy/events/fast11/tech/full_papers/Wei.pdf">techniques</a> will have to be a little different.</p>
<pre tabindex="0"><code>sudo dd if=/dev/zero of=/dev/sdb iflag=nocache oflag=direct bs=4096
</code></pre><p><strong>Please don&rsquo;t copy/paste this command directly</strong>, as you could risk destroying your current system. I&rsquo;m not responsible for anything you break. ü§∑‚Äç‚ôÇÔ∏è</p>
<h2 id="step-3---create-partition">Step 3 - Create partition<a hidden class="anchor" aria-hidden="true" href="#step-3---create-partition">#</a></h2>
<p>Start by creating a partition using <em>fdisk</em>.</p>
<pre tabindex="0"><code>sudo fdisk /dev/sdb
</code></pre><p>Use the <em>n</em> option to create a new partition, then press <em>p</em> for a primary partition. Press <em>1</em> to¬† edit the first partition, then use the defaults for first and last sectors (this will fill up the entire drive). Finally, press <em>w</em> to write your changes.</p>
<pre tabindex="0"><code>Command (m for help): n
Partition type
   p   primary (0 primary, 0 extended, 4 free)
   e   extended (container for logical partitions)
Select (default p): p
Partition number (1-4, default 1): 1
First sector (2048-1953458175, default 2048): 
Last sector, +sectors or +size{K,M,G,T,P} (2048-1953458175, default 1953458175): 

Created a new partition 1 of type &#39;Linux&#39; and of size 931.5 GiB.

Command (m for help): w
The partition table has been altered.
Calling ioctl() to re-read partition table.
Syncing disks.
</code></pre><p>Running <em>lsblk</em> again, we can see our new partition, <em>/dev/sdb1</em>.</p>
<pre tabindex="0"><code>NAME                      MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINT
sda                         8:0    0 298.1G  0 disk  
‚îú‚îÄsda1                      8:1    0  1007K  0 part  
‚îú‚îÄsda2                      8:2    0   128M  0 part  /boot
‚îî‚îÄsda3                      8:3    0   298G  0 part  
  ‚îî‚îÄVolGroup00            254:0    0   298G  0 crypt 
    ‚îú‚îÄVolGroup00-lvolswap 254:1    0     8G  0 lvm   [SWAP]
    ‚îú‚îÄVolGroup00-lvolroot 254:2    0    25G  0 lvm   /
    ‚îî‚îÄVolGroup00-lvolhome 254:3    0   265G  0 lvm   /home
sdb                         8:16   0 931.5G  0 disk  
‚îî‚îÄsdb1                      8:17   0 931.5G  0 part
</code></pre><h2 id="step-4---encrypt-partition">Step 4 - Encrypt partition<a hidden class="anchor" aria-hidden="true" href="#step-4---encrypt-partition">#</a></h2>
<p>Here, we&rsquo;ll setup encryption on our new partition.</p>
<pre tabindex="0"><code>sudo cryptsetup -v -y -c aes-xts-plain64 -s 512 -h sha512 -i 5000 --use-random luksFormat /dev/sdb1
</code></pre><table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-v</code></td>
<td>verbose</td>
</tr>
<tr>
<td><code>-y</code></td>
<td>verify passphrase, ask twice, and complain if they don&rsquo;t match</td>
</tr>
<tr>
<td><code>-c</code></td>
<td>specify the cipher used</td>
</tr>
<tr>
<td><code>-s</code></td>
<td>specify the key size used</td>
</tr>
<tr>
<td><code>-h</code></td>
<td>specify the hash used</td>
</tr>
<tr>
<td><code>-i</code></td>
<td>number of milliseconds to spend passphrase processing (if using anything more than sha1, must be great than 1000)</td>
</tr>
<tr>
<td><code>--use-random</code></td>
<td>which random number generator to use</td>
</tr>
<tr>
<td><code>luksFormat</code></td>
<td>to initialize the partition and set a passphrase</td>
</tr>
<tr>
<td><code>/dev/sdb1</code></td>
<td>the partition to encrypt</td>
</tr>
</tbody>
</table>
<p>Seriously, read the <a href="http://www.dsm.fordham.edu/cgi-bin/man-cgi.pl?topic=cryptsetup">man page</a> and the <a href="https://gitlab.com/cryptsetup/cryptsetup/wikis/FrequentlyAskedQuestions">FAQ</a> on cryptsetup before you do anything here.</p>
<p>To see the configuration of the header, use the command below.</p>
<pre tabindex="0"><code>sudo cryptsetup luksDump /dev/sdb1
</code></pre><h2 id="step-45---backup-the-luks-header">Step 4.5 - Backup the LUKS header<a hidden class="anchor" aria-hidden="true" href="#step-45---backup-the-luks-header">#</a></h2>
<p>The LUKS header stores metadata about the LUKS device, as well as the master key, key files, etc&hellip; Specifically, from the cryptsetup <a href="https://gitlab.com/cryptsetup/cryptsetup/wikis/FrequentlyAskedQuestions#6-backup-and-data-recovery">FAQ</a> and <a href="https://gitlab.com/cryptsetup/cryptsetup/wikis/LUKS-standard/on-disk-format.pdf">specification</a>:</p>
<blockquote>
<p>A LUKS partition starts with the LUKS partition header (phdr) and is followed by key material. After the key material, the bulk data is located, which is encrypted by the master key. The phdr contains information about the used cipher, cipher mode, the key length, a uuid and a master key checksum. Also, the phdr contains information about the key slots. Every key slot is associated with a key material section after the phdr.¬† When a key slot is active, the key slot stores an encrypted copy of the master key in its key material section. This encrypted copy is locked by a user password. Supplying this user password unlocks the decryption for the key material, which stores the master key. The master key in turn unlocks the bulk data. For a key slot, all parameters how to decrypt its key material with a given user password are stored in the phdr (f.e. salt, iteration depth).</p>
</blockquote>
<p>That paragraph is probably easier explained with an <a href="https://nnc3.com/mags/LM10/Magazine/Archive/2005/61/065-071_encrypt/article.html">image</a>.</p>

<p><img src="/2015/05/encrypted-external-drive-with-luks/20150505_002_hucfa8b0e31a32b8235cd7a832fa93fc96_20909_800x0_resize_catmullrom_3.png" loading="lazy" alt="screenshot"></p>
<p>If you don&rsquo;t understand already, it&rsquo;s important to not damage the LUKS header. It&rsquo;s best practice to <a href="https://gitlab.com/cryptsetup/cryptsetup/wikis/FrequentlyAskedQuestions#6-backup-and-data-recovery">backup the header</a> as soon as you create the LUKS device, because you&rsquo;re probably lazy and won&rsquo;t do it later. If you damage the header at all (accidental formatting, wrong device when using <em>dd</em>, bad block, etc&hellip;), you&rsquo;ll need this backup header to recover the data. The header file itself needs encrypted and should be stored in safe place (not on the same drive, obviously).</p>
<pre tabindex="0"><code>sudo cryptsetup luksHeaderBackup --header-backup-file /path/to/file.img /dev/sdb1
</code></pre><p>Note - TrueCrypt (brilliant piece of software) uses a <a href="http://www.wilderssecurity.com/threads/truecrypt-file-partition-drive.349445/#post-2246156">backup header</a> at the end of the drive as well, to mitigate the risk of a single header.</p>
<h2 id="step-5---unlock-the-luks-device">Step 5 - Unlock the LUKS device<a hidden class="anchor" aria-hidden="true" href="#step-5---unlock-the-luks-device">#</a></h2>
<p>Open the LUKS container using the passphrase you just set. This will mount the device at <em>/dev/mapper/volume01</em>.</p>
<pre tabindex="0"><code>sudo cryptsetup luksOpen /dev/sdb1 volume01
</code></pre><h2 id="step-6---create-filesystem">Step 6 - Create filesystem<a hidden class="anchor" aria-hidden="true" href="#step-6---create-filesystem">#</a></h2>
<p>I&rsquo;m going to be using <a href="https://en.wikipedia.org/wiki/Ext4">ext4</a>. Again, specify the name of device you set in the step above.</p>
<pre tabindex="0"><code>sudo mkfs.ext4 /dev/mapper/volume01
</code></pre><h2 id="step-7---mount-device">Step 7 - Mount device<a hidden class="anchor" aria-hidden="true" href="#step-7---mount-device">#</a></h2>
<p>Here, create a mount point, then mount the device to that location.</p>
<pre tabindex="0"><code>sudo mkdir -p /mnt/drive01
sudo mount /dev/mapper/volume01 /mnt/drive01
</code></pre><h2 id="step-8---unmount-and-close-container">Step 8 - Unmount and close container<a hidden class="anchor" aria-hidden="true" href="#step-8---unmount-and-close-container">#</a></h2>
<p>Now, unmount the drive and close the LUKS container.</p>
<pre tabindex="0"><code>sudo umount /mnt/drive01
sudo cryptsetup luksClose /dev/mapper/volume01
</code></pre><h1 id="mounting-the-encrypted-drive">Mounting the encrypted drive<a hidden class="anchor" aria-hidden="true" href="#mounting-the-encrypted-drive">#</a></h1>
<p>Every time you want to use this drive, you&rsquo;ll need to open the LUKS container, mount the drive, do your work, unmount the drive, then close the LUKS container. You can do this manually, or a file manager to auto-mount it.</p>
<h2 id="manual">Manual<a hidden class="anchor" aria-hidden="true" href="#manual">#</a></h2>
<p>Below are the steps to manually unlock and use the drive.</p>
<pre tabindex="0"><code>sudo cryptsetup luksOpen /dev/sdb1 volume01
sudo mount /dev/mapper/volume01 /mnt/drive01
##DO YOUR WORK HERE##
sudo umount /mnt/drive01
sudo cryptsetup luksClose /dev/mapper/volume01
</code></pre><h2 id="automatic">Automatic<a hidden class="anchor" aria-hidden="true" href="#automatic">#</a></h2>
<p>Modern file managers like <a href="https://wiki.archlinux.org/index.php/Thunar">Thunar</a> and <a href="https://wiki.archlinux.org/index.php/GNOME_Files">Nautilus</a> have support for unlocking and mounting LUKS devices automatically. The only downside to this setup is that you can&rsquo;t use keyfiles in addition to passphrases.</p>
<h3 id="install-and-configure-thunar">Install and configure Thunar<a hidden class="anchor" aria-hidden="true" href="#install-and-configure-thunar">#</a></h3>
<p>If you don&rsquo;t have Thunar, you&rsquo;ll need it, along with a couple other packages.</p>
<pre tabindex="0"><code>sudo pacman -S thunar thunar-volman gvfs gvfs-afc
</code></pre><p>Open Thunar and navigate to <em>Edit</em>&ndash;&gt;<em>Preferences</em>&ndash;&gt;<em>Advanced</em> and ensure that <em>Enable Volume Management</em> is checked.</p>

<p><img src="/2015/05/encrypted-external-drive-with-luks/20150505_005.png" loading="lazy" alt="screenshot"></p>
<p>Click on <em>Configure</em>, and ensure that <em>Mount removable drives when hot-plugged</em> and <em>Mount removable media when inserted</em> are both checked. Click on <em>Close</em> to save your changes.</p>

<p><img src="/2015/05/encrypted-external-drive-with-luks/20150505_006.png" loading="lazy" alt="screenshot"></p>
<h3 id="mount-drive">Mount drive<a hidden class="anchor" aria-hidden="true" href="#mount-drive">#</a></h3>
<p>Plug in your external drive and open Thunar. In the top-left, you should see your drive under <em>DEVICES</em>.</p>

<p><img src="/2015/05/encrypted-external-drive-with-luks/20150505_003.png" loading="lazy" alt="screenshot"></p>
<p>When you click on the drive, you&rsquo;ll be prompted for the passphrase you set earlier.</p>

<p><img src="/2015/05/encrypted-external-drive-with-luks/20150505_004.png" loading="lazy" alt="screenshot"></p>
<p>To unmount the drive, right-click on it and select <em>Unmount</em>.</p>
<p>-Logan</p>
<h1 id="comments">Comments<a hidden class="anchor" aria-hidden="true" href="#comments">#</a></h1>
<p><a href="/2015/05/encrypted-external-drive-with-luks/comments.txt">Old comments from WordPress</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>

<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Encrypted external drive with LUKS on twitter"
        href="https://twitter.com/intent/tweet/?text=Encrypted%20external%20drive%20with%20LUKS&amp;url=https%3a%2f%2floganmarchione.github.io%2f2015%2f05%2fencrypted-external-drive-with-luks%2f&amp;hashtags=">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Encrypted external drive with LUKS on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2floganmarchione.github.io%2f2015%2f05%2fencrypted-external-drive-with-luks%2f&amp;title=Encrypted%20external%20drive%20with%20LUKS&amp;summary=Encrypted%20external%20drive%20with%20LUKS&amp;source=https%3a%2f%2floganmarchione.github.io%2f2015%2f05%2fencrypted-external-drive-with-luks%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Encrypted external drive with LUKS on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2floganmarchione.github.io%2f2015%2f05%2fencrypted-external-drive-with-luks%2f&title=Encrypted%20external%20drive%20with%20LUKS">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Encrypted external drive with LUKS on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2floganmarchione.github.io%2f2015%2f05%2fencrypted-external-drive-with-luks%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Encrypted external drive with LUKS on whatsapp"
        href="https://api.whatsapp.com/send?text=Encrypted%20external%20drive%20with%20LUKS%20-%20https%3a%2f%2floganmarchione.github.io%2f2015%2f05%2fencrypted-external-drive-with-luks%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Encrypted external drive with LUKS on telegram"
        href="https://telegram.me/share/url?text=Encrypted%20external%20drive%20with%20LUKS&amp;url=https%3a%2f%2floganmarchione.github.io%2f2015%2f05%2fencrypted-external-drive-with-luks%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://loganmarchione.github.io">Logan Marchione</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><div class="kb-club">
  <a target="_blank" href="https://512kb.club"><img src="/assets/assets/512kb-club-green-team.svg" ></a>
</div>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
